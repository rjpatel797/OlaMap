    
    <script>
       var url=API+"Jsoncontroller?";
        var query="Operation=getDevicedetailbymid";
        //alert(url+query);
        $.ajax({
            type: "GET",
            url: url+query,
            dataType: "jsonp",
            success: function(msg2) 
            {
           // alert(msg2);
            	 var conten="";
              	var msg = eval(msg2);

            	var select= '<select name="deviceId" id="deviceId" class="form-control select2" data-placeholder="Select a Device" style="width: 100%;">';
                for(var i=0;i<msg.length;i++)
                {
                	conten = conten+' <option value="'+msg[i].DeviceID+'">'+msg[i].Devicename+'</option>';
                }
                $("#Getdevice").html(select+conten+"</select>");
              //  alert(conten);
                $(".select2").select2({
              	  tags: "true",
              	  placeholder: "Select an option",
              	  allowClear: true
              	});
            }
        });
        

  //Date range picker with time picker
        $('#reservationtime').daterangepicker({timePicker: true, timePickerIncrement: 30, format: 'DD/MM/YYYY HH:mm',timePicker12Hour: false});

 
  
  
  function initdtforreport()
  {
  	var reservationtime=document.getElementById("reservationtime").value;
  	var date=reservationtime.split("-");
  	var reportname=document.getElementById("reportname").value;
  	var from=date[0];
  	var end=date[1];
  	// alert("sadgsadg");
  	  $("div.tbl-tools-searchbox select").addClass(
   	  'tbl_length');
   	$('#expiryreport')
   	  .dataTable(
   	  {
   		              
   		 "scrollX": true,            
   	  "sPaginationType" : "full_numbers",
   	  "oLanguage" : {
   	  "sLengthMenu" : "<span class='lenghtMenu' > _MENU_</span><span class='lengthLabel'></span>"
   	  },
   	  //"sDom" : '<"tbl-tools-searchbox"fl<"clear">>,<"tbl_tools"CT<"clear">>,<"table_content"t>,<"widget-bottom"p<"clear">>',
   	 "sDom": 'T<"clear">lfrtip',
   	

   	  "oTableTools" : {
   	  "sSwfPath" : "plugins/datatables/extensions/TableTools/swf/copy_csv_xls_pdf.swf",
   	 "aButtons": [
   	                "copy",
   	                "csv",
   	                "xls",
   	                {
   	                    "sExtends": "pdf",
   	                    "sPdfMessage": "Report From:  "+from+" Report To:  "+end,
   	                   "sTitle" : reportname
   	                }
   	            ]
   	  }
   	             
   	  
   	               
   	  });
   	
  }
  </script>
 <section class="content">
      <div class="box box-default" >
        <div class="box-header with-border" style="background-color: #3C8DBC;">

 <h3 class="box-title" style="margin-left: 45%;color: #ffffff;"> <b>History Report</b></h3>
  <div class="box-tools pull-right">
            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
          </div>
           </div>
           <div class="box-body">
 <div class="row">     
        <div class="col-xs-6">
        <label>Date and time range:</label>
                <div class="input-group">
                  <div class="input-group-addon">
                    <i class="fa fa-clock-o"></i>
                  </div>
                  <input type="text" class="form-control pull-right " id="reservationtime">
                </div>
        </div>
          <div class="col-xs-4">
          <label for="deviceId">Device:</label>
           <div id="Getdevice"></div>
          </div>
           <div class="col-xs-2">
          <label for="interval">Time Interval:</label><br/>
                        <select name="interval" id="interval" onchange="onspeed()" >
                         <option value="1">1 Min</option>
                          <option value="2">2 Min</option>
                         <option value="5">5 Min</option>
                        <option value="10">10 Min</option>
                        <option value="15">15 Min</option>
                        <option value="30">30 Min</option>
                        <option value="60" selected="selected">1 Hour</option>
                       
                        
                    </select>
          
          </div>
        </div>
         <div class="row" style="margin-top: 4%;margin-left: 50%;">
        <div class="col-xs-3 ">
        <input class="btn btn-success" type="button" name="Submit" value="Submit" onclick="submit()" />
        </div>
        </div>
       </div>
       </div>
       <input type="hidden" id="reportname" value="History Report" />
        </section>
        
               
      <ul class="nav nav-tabs" role="tablist">
   <li role="presentation" class="active"><a href="#Gridview" aria-controls="Gridview" role="tab" data-toggle="tab" onclick="Gridview()">Grid view</a></li>
    <li role="presentation" ><a href="#Listview" aria-controls="Listview" role="tab" data-toggle="tab" onclick="listview()">List view</a></li> 
<!--     <li role="presentation"><a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">Graphs</a></li> -->
  </ul>

  <!-- Tab panes -->
  <div class="tab-content">
   <div role="tabpanel" class="tab-pane active" id="Gridview" style="margin-top: 1%;">
   <div  id="fleetsummryreportgirdview" style="text-align: center">
  </div>
    <div role="tabpanel" class="tab-pane " id="Listview" ><div  id="fleetsummryreportlistview" style="text-align: center"> </div></div>
   
   <!--  <div role="tabpanel" class="tab-pane" id="Graphsview">...</div> -->
  </div>

</div>
      
<script>
var msg="";
 // $("#deviceId").iCheck('check');
  function submit()
  {
	  var date=$("#reservationtime").val();
	  var time=$("#interval").val();
	  if(date=="" || date==null)
		  {
		  alert("Please select Date And Time");
		  }
	  else if($("#deviceId").val()=="" || $("#deviceId").val()==null)
		  {
		  alert("Please select at least one Device Name");
		  }
	  else{
		  
	  var spilt=date.split("-");
	  
	   var dataarray = new Array();
	  var url=API+"Jsoncontroller?Operation=";
      var query="getdetailhistroyreport&did="+$("#deviceId").val()+"&fromdate="+spilt[0]+"&todate="+spilt[1]+"&time="+time;
	//alert(url+query);
	$.ajax({
    type: "GET",
    url: url+query,
    dataType: "jsonp",
    beforeSend: function(HttpRequest) {
    //	$("#Getdevice").html(' <img src="images/loading.gif"/>');
    },
    success: function(msg2) 
    {
    //  alert(msg2);
        msg = eval(msg2);
         
           var contcsv="";
           Gridview();
   
    }
	});
	

	  } 
  }
  
  function listview()
  {
  	  var conten="";
  	  $("#fleetsummryreportgirdview").html('');
  	  var inittable= '<table  id="expiryreport" class="table   table-striped" style="border-color:#3C8DBC;" ><thead style="background-color:#3C8DBC; color:white;"><tr><th><b>Device Name</b></th><th><b>Date</b></th><th><b>Speed</b></th><th><b>POI Location</b></th><th><b>Location</b></th></tr></thead><tbody>';
        var closetable='</tbody></tr></table></div>';
        for(var i=0;i<msg.length;i++)
        {
            conten = conten+ '<tr><td>'+msg[i].devicename+'</td><td>'+msg[i].date+'</td><td>'+msg[i].speed+'</td><td>'+msg[i].poilocation+'</td><td>'+msg[i].Location+'</td></tr>';
        }
       
        $("#fleetsummryreportlistview").html(inittable+conten+closetable);
        initdtforreport();
  }
  
  
  function Gridview()
  {
  	$("#fleetsummryreportlistview").html('');
   	var divbody="";
	  var initdiv = '';
	  var closediv='';
      for (var i = 0; i < msg.length; i++)
      {
    	  divbody += '<div class="box box-success"><div id="box-header with-border"><div class="box-body"><div class="row"><div class="col-xs-6" style="text-align: center;"><h3 style="text-align: center;color:blue;" >'+ msg[i].devicename+'</h3></div><div class="col-xs-6" style="text-align: center;"><h3 style="text-align: center;color:red;">'+ msg[i].date+' </h3><br/></div></div><div class="row"><div class="col-xs-6" style="text-align: center;"><img src="androimage/spsix.png"><br/><label>' +msg[i].speed+ ' Km/hr</label></div><div class="col-xs-6" style="text-align: center;"><label>'
          +msg[i].poilocation+'</label><br/><label style="color:blue;">POI Location</label></div>'
          +'</div><br/><div class="row" style="text-align: center;"><label>' +msg[i].Location+ '</label>'
          +'</div></div></div></div>';
      }
    //  alert(tableheader+tablebody);
    
      $("#fleetsummryreportgirdview").html(initdiv+divbody+closediv);
  }
  function onspeed()
  {
      if($("#interval").val() < 300)
          {
      $("#googles").attr("disabled", true);
          }
          else
              {
                  $("#googles").removeAttr("disabled", true);
              }
  }
  
</script>
